<template>
    <tr>
        <td class="form-group mt-3">
            <div class="d-flex align-items-center">
                <div for="billing" class="d-inline mr-2">{{ index+1 }}. <strong>Billing:</strong></div>
                <div class="input-group w-50">
                    <input type="number" class="form-control input-billing" v-model="billing.percentage" step="0.01" min="0" :name="billing.isNew ? 'new_billing[]' : 'billing[][' + billing.id + ']'" :disabled="billing.finance_invoice_id">
                    <div class="input-group-append">
                        <span class="input-group-text">%</span>
                    </div>
                </div>
            </div>
        </td>
        <td>
            {{ currency }}&nbsp;{{ billingCostWithoutGst }}
        </td>
        <td v-show="clientCountryGstApplicable">
            {{ currency }}&nbsp;{{ billingGstAmount }}
        </td>
        <td v-show="clientCountryGstApplicable">
            {{ currency }}&nbsp;{{ billingCostWithGst }}
        </td>
        <td v-if="billing.finance_invoice_id">
            <a target="_blank" :href="'/finance/invoices/download/' + billing.invoice.file_path"><i class="fa fa-file fa-2x text-primary btn-file"></i></a>
        </td>
        <td v-else>
            <span class="modal-toggler text-primary" data-toggle="modal" data-target="#myModal" @click="$emit('addBillingInvoice', billing.id)">Create invoice</span>
        </td>
    </tr>
</template>

<script>
    export default {
        props: ['billing', 'index', 'stageCostWithGst', 'gstAmount', 'stageCostWithoutGst', 'currency', 'clientCountryGstApplicable'],
        computed: {
            billingCostWithoutGst: function() {
                return parseFloat((this.billing.percentage/100)*this.stageCostWithoutGst);
            },
            billingGstAmount: function() {
                return parseFloat((this.billing.percentage/100)*this.gstAmount);
            },
            billingCostWithGst: function() {
                return parseFloat((this.billing.percentage/100)*this.stageCostWithGst);
            }
        }
    }
</script>
